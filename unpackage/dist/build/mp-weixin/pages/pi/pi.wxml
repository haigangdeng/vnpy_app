<view class="grace-body"><view class="grace-margin-top"></view><view class="grace-list"><view class="items"><view>当前轮次：<text>{{piShifts[currentShift]}}</text></view></view><view class="items"><view>当前方式：<text>{{piModes[currentMode]}}</text></view></view></view><view class="ucenter-line"></view><view class="grace-form"><block wx:if="{{currentMode==0}}"><view class="grace-items"><text class="grace-icons icon-position grace-light-blue"></text><text class="margin-right-ten"></text><view class="grace-label">库位</view><input class="input text-align-left" name="locationCode" disabled="{{locationCodeDisable}}" placeholder="请扫库位或手动输入" data-event-opts="{{[['input',[['__set_model',['','locationCode','$event',[]]]]]]}}" value="{{locationCode}}" bindinput="__e"/><view data-event-opts="{{[['tap',[['scanLocationCode',['$event']]]]]}}" class="grace-icons icon-photograph icon grace-blue" bindtap="__e"></view></view></block><block wx:if="{{currentMode==0}}"><view><button type="primary" data-event-opts="{{[['tap',[['searchByLocation',['$event']]]]]}}" bindtap="__e">查找</button></view></block><block wx:if="{{currentMode==1}}"><view class="grace-items"><text class="dotnet-icons icon-wms-scan grace-blue"></text><text class="margin-right-ten"></text><view class="grace-label">料号</view><input class="input text-align-left" name="itemCode" disabled="{{itemCodeDisable}}" placeholder="请扫料号或手动输入" data-event-opts="{{[['input',[['__set_model',['','itemCode','$event',[]]]]]]}}" value="{{itemCode}}" bindinput="__e"/><view data-event-opts="{{[['tap',[['scanItemCode',['$event']]]]]}}" class="grace-icons icon-photograph icon grace-blue" bindtap="__e"></view></view></block><block wx:if="{{currentMode==1}}"><view><button type="primary" data-event-opts="{{[['tap',[['searchByItem',['$event']]]]]}}" bindtap="__e">查找</button></view></block></view><block wx:if="{{currentMode!=2}}"><view class="ucenter-line"></view></block><grace-nav vue-id="1" items="{{categories}}" lineHeight="60rpx" isCenter="{{true}}" currentIndex="{{currentCategorieIndex}}" size="{{160}}" activeLineBg="#3688FF" textAlign="center" activeColor="#3688FF" activeLineWidth="100%" activeLineHeight="3rpx" margin="{{10}}" data-event-opts="{{[['^change',[['navChange']]]]}}" bind:change="__e" bind:__l="__l"></grace-nav><block wx:for="{{piList}}" wx:for-item="piItem" wx:for-index="index" wx:key="index"><view class="grace-card-view"><block wx:if="{{currentShift==0}}"><view class="body"><view class="desc"><view>仓库：<text class="grace-badge grace-bg-blue">{{piItem.WarehouseCode}}</text></view><block wx:if="{{currentProjectInfo.IsLocationCodeEnabled==1}}"><view>库位：<text>{{piItem.LocationCode}}</text></view></block><block wx:if="{{currentProjectInfo.IsProjectEnabled==1}}"><view>项目：<text>{{piItem.Project}}</text></view></block><view>料号：<text>{{piItem.ItemCode}}</text></view><view>描述：<text>{{piItem.ItemName}}</text></view><block wx:if="{{currentProjectInfo.IsLotNumberEnabled==1}}"><view>批次号码：<text>{{piItem.LotNumber}}</text></view></block><block wx:if="{{currentProjectInfo.IsShowSystemQuantity==1}}"><view>系统数量：<text class="grace-badge grace-bg-black">{{piItem.SystemQuantity}}</text></view></block><block wx:if="{{piItem.IsFirstCounted==1}}"><block><view>初盘数量：<text class="grace-badge grace-bg-red">{{piItem.FirstActualQuantity}}</text></view><view>初盘备注：<text>{{piItem.FirstCountedRemark}}</text></view></block></block><view>单位：<text>{{piItem.InventoryUnit}}</text></view><view>系统备注：<text>{{piItem.Remark}}</text></view><block wx:if="{{currentProjectInfo.OrderStatusCode==20&&currentProjectInfo.IsShowSystemQuantity==0&&!piItem.ShowUpdated}}"><block><input class="quantityInput" clearable type="digit" name="updateActualQuantity" placeholder="请输入盘点数量" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['updateActualQuantity']]]]]}}" value="{{updateActualQuantity[index]}}" bindinput="__e"/><view><textarea class="feedback-textare" placeholder="备注..." name="piRemark" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['piRemark']]]]]}}" value="{{piRemark[index]}}" bindinput="__e"></textarea></view></block></block><block wx:if="{{currentProjectInfo.OrderStatusCode==20&&piItem.ShowWrongQuantity}}"><block><input class="quantityInput" clearable type="digit" name="updateActualQuantity" placeholder="请输入盘点数量" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['updateActualQuantity']]]]]}}" value="{{updateActualQuantity[index]}}" bindinput="__e"/><view><textarea class="feedback-textare" placeholder="备注..." name="piRemark" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['piRemark']]]]]}}" value="{{piRemark[index]}}" bindinput="__e"></textarea></view></block></block></view><block wx:if="{{piItem.IsFirstCounted==0}}"><view class="img"><image src="../../static/icon/icon-wms-todo.png"></image><view>待处理</view></view></block><block wx:else><view class="img"><image src="../../static/icon/icon-wms-handled.png"></image><view>已处理</view></view></block></view></block><block wx:if="{{currentShift==1}}"><view class="body"><view class="desc"><view>仓库：<text class="grace-badge grace-bg-blue">{{piItem.WarehouseCode}}</text></view><block wx:if="{{currentProjectInfo.IsLocationCodeEnabled==1}}"><view>库位：<text>{{piItem.LocationCode}}</text></view></block><block wx:if="{{currentProjectInfo.IsProjectEnabled==1}}"><view>项目：<text>{{piItem.Project}}</text></view></block><view>料号：<text>{{piItem.ItemCode}}</text></view><view>描述：<text>{{piItem.ItemName}}</text></view><block wx:if="{{currentProjectInfo.IsLotNumberEnabled==1}}"><view>批次号码：<text>{{piItem.LotNumber}}</text></view></block><block wx:if="{{currentProjectInfo.IsShowSystemQuantity==1}}"><view>系统数量：<text class="grace-badge grace-bg-black">{{piItem.SystemQuantity}}</text></view></block><block wx:if="{{currentProjectInfo.IsShowFirstQuantity==1}}"><block><view>初盘数量：<text class="grace-badge grace-bg-red">{{piItem.FirstActualQuantity}}</text></view><view>初盘备注：<text>{{piItem.FirstCountedRemark}}</text></view></block></block><block wx:if="{{piItem.IsSecondCounted==1}}"><block><view>复盘数量：<text class="grace-badge grace-bg-red">{{piItem.SecondActualQuantity}}</text></view><view>复盘备注：<text>{{piItem.SecondCountedRemark}}</text></view></block></block><view>单位：<text>{{piItem.InventoryUnit}}</text></view><view>系统备注：<text>{{piItem.Remark}}</text></view><block wx:if="{{currentProjectInfo.OrderStatusCode==20&&currentProjectInfo.IsShowSystemQuantity==0&&!piItem.ShowUpdated}}"><block><input class="quantityInput" clearable type="digit" name="updateActualQuantity" placeholder="请输入盘点数量" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['updateActualQuantity']]]]]}}" value="{{updateActualQuantity[index]}}" bindinput="__e"/><view><textarea class="feedback-textare" placeholder="备注..." name="piRemark" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['piRemark']]]]]}}" value="{{piRemark[index]}}" bindinput="__e"></textarea></view></block></block><block wx:if="{{currentProjectInfo.OrderStatusCode==20&&piItem.ShowWrongQuantity}}"><block><input class="quantityInput" clearable type="digit" name="updateActualQuantity" placeholder="请输入盘点数量" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['updateActualQuantity']]]]]}}" value="{{updateActualQuantity[index]}}" bindinput="__e"/><view><textarea class="feedback-textare" placeholder="备注..." name="piRemark" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['piRemark']]]]]}}" value="{{piRemark[index]}}" bindinput="__e"></textarea></view></block></block></view><block wx:if="{{piItem.IsSecondCounted==0}}"><view class="img"><image src="../../static/icon/icon-wms-todo.png"></image><view>待处理</view></view></block><block wx:else><view class="img"><image src="../../static/icon/icon-wms-handled.png"></image><view>已处理</view></view></block></view></block><block wx:if="{{currentShift==2}}"><view class="body"><view class="desc"><view>仓库：<text class="grace-badge grace-bg-blue">{{piItem.WarehouseCode}}</text></view><block wx:if="{{currentProjectInfo.IsLocationCodeEnabled==1}}"><view>库位：<text>{{piItem.LocationCode}}</text></view></block><block wx:if="{{currentProjectInfo.IsProjectEnabled==1}}"><view>项目：<text>{{piItem.Project}}</text></view></block><view>料号：<text>{{piItem.ItemCode}}</text></view><view>描述：<text>{{piItem.ItemName}}</text></view><block wx:if="{{currentProjectInfo.IsLotNumberEnabled==1}}"><view>批次号码：<text>{{piItem.LotNumber}}</text></view></block><block wx:if="{{currentProjectInfo.IsShowSystemQuantity==1}}"><view>系统数量：<text class="grace-badge grace-bg-black">{{piItem.SystemQuantity}}</text></view></block><block wx:if="{{currentProjectInfo.IsShowFirstQuantity==1}}"><block><view>初盘数量：<text class="grace-badge grace-bg-red">{{piItem.FirstActualQuantity}}</text></view><view>初盘备注：<text>{{piItem.FirstCountedRemark}}</text></view></block></block><block wx:if="{{currentProjectInfo.IsShowSecondQuantity==1}}"><block><view>复盘数量：<text class="grace-badge grace-bg-red">{{piItem.SecondActualQuantity}}</text></view><view>复盘备注：<text>{{piItem.SecondCountedRemark}}</text></view></block></block><block wx:if="{{piItem.isThirdCounted==1}}"><block><view>三盘数量：<text class="grace-badge grace-bg-red">{{piItem.ThirdActualQuantity}}</text></view><view>三盘备注：<text>{{piItem.ThirdCountedRemark}}</text></view></block></block><view>单位：<text>{{piItem.InventoryUnit}}</text></view><view>系统备注：<text>{{piItem.Remark}}</text></view><block wx:if="{{currentProjectInfo.OrderStatusCode==20&&currentProjectInfo.IsShowSystemQuantity==0&&!piItem.ShowUpdated}}"><block><input class="quantityInput" clearable type="digit" name="updateActualQuantity" placeholder="请输入盘点数量" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['updateActualQuantity']]]]]}}" value="{{updateActualQuantity[index]}}" bindinput="__e"/><view><textarea class="feedback-textare" placeholder="备注..." name="piRemark" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['piRemark']]]]]}}" value="{{piRemark[index]}}" bindinput="__e"></textarea></view></block></block><block wx:if="{{currentProjectInfo.OrderStatusCode==20&&piItem.ShowWrongQuantity}}"><block><input class="quantityInput" clearable type="digit" name="updateActualQuantity" placeholder="请输入盘点数量" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['updateActualQuantity']]]]]}}" value="{{updateActualQuantity[index]}}" bindinput="__e"/><view><textarea class="feedback-textare" placeholder="备注..." name="piRemark" data-event-opts="{{[['input',[['__set_model',['$0',index,'$event',[]],['piRemark']]]]]}}" value="{{piRemark[index]}}" bindinput="__e"></textarea></view></block></block></view><block wx:if="{{piItem.IsThirdCounted==0}}"><view class="img"><image src="../../static/icon/icon-wms-todo.png"></image><view>待处理</view></view></block><block wx:else><view class="img"><image src="../../static/icon/icon-wms-handled.png"></image><view>已处理</view></view></block></view></block><block wx:if="{{currentProjectInfo.OrderStatusCode==20}}"><block><block wx:if="{{!piItem.ShowUpdated}}"><block><block wx:if="{{currentProjectInfo.IsShowSystemQuantity==1}}"><view class="footer"><block wx:if="{{!piItem.ShowWrongQuantity}}"><block><view data-event-opts="{{[['tap',[['actionUpdate',['$0',currentShift+1,'$1',index,false,'$2'],[[['piList','',index,'Id']],[['piList','',index,'SystemQuantity']],'piRemark.'+index+'']]]]]}}" bindtap="__e"><view class="dotnet-icons icon-wms-like grace-green"><text class="margin-right-ten"></text>账实相符</view></view><view data-event-opts="{{[['tap',[['showWrongQuantity',[index]]]]]}}" bindtap="__e"><view class="dotnet-icons icon-wms-question grace-red"><text class="margin-right-ten"></text>数量有误</view></view><view data-event-opts="{{[['tap',[['actionUpdate',['$0',currentShift+1,0,index,false,'$1'],[[['piList','',index,'Id']],'piRemark.'+index+'']]]]]}}" bindtap="__e"><view class="dotnet-icons icon-wms-dislike grace-gray"><text class="margin-right-ten"></text>无此库存</view></view></block></block><block wx:else><block><view data-event-opts="{{[['tap',[['actionUpdate',['$0',currentShift+1,'$1',index,true,'$2'],[[['piList','',index,'Id']],'updateActualQuantity.'+index+'','piRemark.'+index+'']]]]]}}" bindtap="__e"><view class="dotnet-icons iconwms-save grace-green"><text class="margin-right-ten"></text>提交盘点</view></view></block></block></view></block><block wx:else><view class="footer"><view data-event-opts="{{[['tap',[['actionUpdate',['$0',currentShift+1,'$1',index,true,'$2'],[[['piList','',index,'Id']],'updateActualQuantity.'+index+'','piRemark.'+index+'']]]]]}}" bindtap="__e"><view class="dotnet-icons iconwms-save grace-green"><text class="margin-right-ten"></text>提交盘点</view></view></view></block></block></block><block wx:else><block><view class="footer"><view><view><text></text>已完成</view></view></view></block></block></block></block><block wx:if="{{currentProjectInfo.OrderStatusCode==0}}"><block><view class="footer"><view><view><text></text>项目已取消</view></view></view></block></block><block wx:if="{{currentProjectInfo.OrderStatusCode==1||currentProjectInfo.OrderStatusCode==10}}"><block><view class="footer"><view><view><text></text>项目创建中</view></view></view></block></block><block wx:if="{{currentProjectInfo.OrderStatusCode==50}}"><block><view class="footer"><view><view><text></text>项目暂停</view></view></view></block></block><block wx:if="{{currentProjectInfo.OrderStatusCode==100}}"><block><view class="footer"><view><view><text></text>项目已完成</view></view></view></block></block></view></block><block wx:if="{{currentCategorieIndex==3}}"><view class="grace-margin-top"><view class="grace-form grace-margin-top"><block wx:if="{{currentProjectInfo.IsCompanyEnabled==1}}"><view class="grace-items"><text class="grace-icons icon-star grace-light-blue"></text><text class="margin-right-ten"></text><view class="grace-label">公司</view><input class="input text-align-left" name="addCompany" placeholder="请扫公司或手动输入" data-event-opts="{{[['input',[['__set_model',['','addCompany','$event',[]]]]]]}}" value="{{addCompany}}" bindinput="__e"/><block wx:if="{{addCompany.length>0}}"><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="grace-form-funs grace-icons icon-close" bindtap="__e"></view></block></view></block><block wx:if="{{currentProjectInfo.IsSiteEnabled==1}}"><view class="grace-items"><text class="grace-icons icon-star grace-light-blue"></text><text class="margin-right-ten"></text><view class="grace-label">工厂</view><input class="input text-align-left" name="addSite" placeholder="请扫工厂或手动输入" data-event-opts="{{[['input',[['__set_model',['','addSite','$event',[]]]]]]}}" value="{{addSite}}" bindinput="__e"/><block wx:if="{{addSite.length>0}}"><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" class="grace-form-funs grace-icons icon-close" bindtap="__e"></view></block></view></block><view class="grace-items"><text class="dotnet-icons icon-wms-by-location grace-light-blue"></text><text class="margin-right-ten"></text><view class="grace-label">仓库</view><input class="input text-align-left" name="addWarehouseCode" placeholder="请扫仓库或手动输入" data-event-opts="{{[['input',[['__set_model',['','addWarehouseCode','$event',[]]]]]]}}" value="{{addWarehouseCode}}" bindinput="__e"/><block wx:if="{{addWarehouseCode.length>0}}"><view data-event-opts="{{[['tap',[['e2',['$event']]]]]}}" class="grace-form-funs grace-icons icon-close" bindtap="__e"></view></block></view><view class="grace-items"><text class="grace-icons icon-position grace-light-blue"></text><text class="margin-right-ten"></text><view class="grace-label">库位</view><input class="input text-align-left" name="addLocationCode" placeholder="请扫库位或手动输入" data-event-opts="{{[['input',[['__set_model',['','addLocationCode','$event',[]]]]]]}}" value="{{addLocationCode}}" bindinput="__e"/><block wx:if="{{addLocationCode.length>0}}"><view data-event-opts="{{[['tap',[['e3',['$event']]]]]}}" class="grace-form-funs grace-icons icon-close" bindtap="__e"></view></block></view><block wx:if="{{currentProjectInfo.IsProjectEnabled==1}}"><view class="grace-items"><text class="grace-icons icon-star grace-light-blue"></text><text class="margin-right-ten"></text><view class="grace-label">项目</view><input class="input text-align-left" name="addProject" placeholder="请扫项目或手动输入" data-event-opts="{{[['input',[['__set_model',['','addProject','$event',[]]]]]]}}" value="{{addProject}}" bindinput="__e"/><block wx:if="{{addProject.length>0}}"><view data-event-opts="{{[['tap',[['e4',['$event']]]]]}}" class="grace-form-funs grace-icons icon-close" bindtap="__e"></view></block></view></block><view class="grace-items"><text class="dotnet-icons icon-wms-scan grace-blue"></text><text class="margin-right-ten"></text><view class="grace-label">料号</view><input class="input text-align-left" name="addItemCode" placeholder="请扫料号或手动输入" data-event-opts="{{[['input',[['__set_model',['','addItemCode','$event',[]]]]]]}}" value="{{addItemCode}}" bindinput="__e"/><block wx:if="{{addItemCode.length>0}}"><view data-event-opts="{{[['tap',[['e5',['$event']]]]]}}" class="grace-form-funs grace-icons icon-close" bindtap="__e"></view></block></view><block wx:if="{{currentProjectInfo.IsLotNumberEnabled==1}}"><view class="grace-items"><text class="grace-icons icon-share3 grace-light-blue"></text><text class="margin-right-ten"></text><view class="grace-label">批次</view><input class="input text-align-left" name="addLotNumber" placeholder="请扫批次或手动输入" data-event-opts="{{[['input',[['__set_model',['','addLotNumber','$event',[]]]]]]}}" value="{{addLotNumber}}" bindinput="__e"/><block wx:if="{{addLotNumber.length>0}}"><view data-event-opts="{{[['tap',[['e6',['$event']]]]]}}" class="grace-form-funs grace-icons icon-close" bindtap="__e"></view></block></view></block><view class="grace-items"><text class="dotnet-icons icon-wms-check grace-red"></text><text class="margin-right-ten"></text><view class="grace-label">数量</view><input class="input text-align-left" clearable type="digit" name="addActualQuantity" placeholder="请输入数量" data-event-opts="{{[['input',[['__set_model',['','addActualQuantity','$event',[]]]]]]}}" value="{{addActualQuantity}}" bindinput="__e"/><block wx:if="{{addActualQuantity.length>0}}"><view data-event-opts="{{[['tap',[['e7',['$event']]]]]}}" class="grace-form-funs grace-icons icon-close" bindtap="__e"></view></block></view><view class="grace-items"><text class="grace-icons icon-keyboard grace-red"></text><text class="margin-right-ten"></text><view class="grace-label">单位</view><input class="input text-align-left" type="text" name="addUnit" placeholder="请输入单位" data-event-opts="{{[['input',[['__set_model',['','addUnit','$event',[]]]]]]}}" value="{{addUnit}}" bindinput="__e"/><block wx:if="{{addUnit.length>0}}"><view data-event-opts="{{[['tap',[['e8',['$event']]]]]}}" class="grace-form-funs grace-icons icon-close" bindtap="__e"></view></block></view><view><textarea class="addRemark" placeholder="备注..." name="addRemark" data-event-opts="{{[['input',[['__set_model',['','addRemark','$event',[]]]]]]}}" value="{{addRemark}}" bindinput="__e"></textarea></view><view data-event-opts="{{[['tap',[['addNewPiItem',['$0',currentShift+1,'$1','$2','$3','$4','$5','$6','$7','$8'],['currentProjectInfo.Id','addWarehouseCode','addLocationCode','addProject','addItemCode','addLotNumber','addActualQuantity','addUnit','addRemark']]]]]}}" bindtap="__e"><button class="btn-submit" type="primary">立即保存</button></view></view></view></block><view class="grace-margin-top"></view><block wx:if="{{allLoaded}}"><view class="img grace-flex-center grace-wrap title"><view>已加载全部数据</view></view></block></view>